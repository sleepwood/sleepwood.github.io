{"posts":[{"title":"Git 的常用知识与命令","content":"最近因为疫情的原因，需要在家工作，因此打算布置一个外网Git服务器用于版本控制。目前的计划是通过Docker部署Gitea，在部署之前先收集一下日常使用Git时能够用到的语句，记录成笔记的形式，以方便日后工作时查看和温习。 快速入门 初始化Git并上传/下载Git仓库文件 上传或下载Git仓库文件 查看Git仓库状态 初始化Git并上传/下载Git仓库文件 在本机初始化Git并上传文件到Git仓库 git init git add * git commit -m &quot;{提交内容}&quot; git remote add origin {远程Git地址} git push -u origin master 在本机初始化Git并下载文件到Git仓库 git init git remote add origin {远程Git地址} git pull origin master 上传或下载Git仓库文件 在本机上传文件到Git仓库 git add * git commit -m &quot;{提交内容}&quot; git push -u origin master 添加和提交可以合并成一步 git commit -am &quot;{提交内容}&quot; git push -u origin master 在本机下载文件到Git仓库 git pull origin master 查看Git仓库状态 查看当前版本状态（是否修改） git status 显示提交日志 git log 使用进阶 Git的&quot;生命周期&quot; 撤销未暂存与已暂存修改 合并多余的提交 Git的&quot;生命周期&quot; Git于其他版本控制系统之间的一个不同就在于Git存在暂存区。 我们在往Git库中添加文件的时候，是分两步执行的： 第一步是用git add把文件修改添加到暂存区； 第二步是用git commit把暂存区的所有内容提交到当前分支。 我们可以简单地用表格模拟Git提交文件修改的流程： 工作区 暂存区 当前分支 test.md / / test.md git add test.md / test.md git add test.md git commit -m test.md 提交结束后，如果你没有对工作区做任何其他的修改，那么工作区就是“干净”的 撤销工作区与已暂存修改 撤销工作区的修改，使其回到最近一次git commit或git add时的状态。 git checkout -- &lt;file&gt; 注意需要添加 -- 否则将会变成变更分支命令 撤销已经暂存的修改 git reset HEAD &lt;file&gt; 合并多余的提交 多次提交可以合并保存成一个提交（与最后一次提交合并） git commit --amend -m &quot;{提交内容}&quot; Git分支管理 查看分支列表 创建并切换分支 切换到其他分支 合并间分支 删除当前分支 查看分支列表 在管理Git分支前，先查看一下当前存在的分支 git branch 创建并切换分支 我们可以通过一个命令同时创建并切换到新分支 git switch -c &lt;new branch&gt; 切换到某一分支 git switch &lt;branch&gt; 合并某分支到当前分支 git merge &lt;branch&gt; 删除某一分支 git branch -d &lt;branch&gt; 引用链接 廖雪峰的官方网站 git命令大全 ","link":"https://sleepwood.github.io/post/git"},{"title":"如何通过配置自定义文件定义H5ai","content":"我们在搭建好h5ai程序后，如果对网站的布局、显示方式等不满意，可以通过h5ai提供的丰富的配置文件进行进行个性化定制。配置文件在 _h5ai/private/conf/options.json ，我在官网上并没有找到对配置文件的详细说明，因此在这里把整个文件进行详细说明和翻译，以备不时之需。 密码哈希值 — Password hash 字段 类型 备注 passhash SHA512 hash 信息页面密码的哈希值（默认密码为空） 哈希值生成网址： Online hash generator 外部资源 — resources 字段 类型 备注 resources / 外部的脚本和样式表将以tag的形式添加到所有页面 ├ scripts 数组 外部的js文件 └ styles 数组 外部的css文件 显示设置 — view 字段 类型 备注 view / 页面总设置 ├ binaryPrefix 布尔型 格式化文件是否换算二进制单位(1024B=1KiB)1 ├ disableSidebar 布尔型 隐藏侧边栏及显示按钮 ├ fallbackMode 布尔型 使用服务器回调模式 ├ fastBrowsing 布尔型 使用可用的历史API (不需要重载整个页面) ├ fonts 数组 网站常用的字体文件 ├ fontsMono 数组 网站常用的等宽字体 ├ hidden 布尔型 在这里设置不希望显示的文件/文件夹 ├ hideFolders 数布尔型组 隐藏页面所有文件夹 ├ hideIf403 布尔型 隐藏所有服务器上不可读的文件/文件夹 ├ hideParentFolder 布尔型 在页面隐藏父文件夹的链接 ├ maxIconSize 数字 页面图标大小的最大值 ├ modes 数组 页面显示模式(&quot;details&quot;, &quot;grid&quot;, &quot;icons&quot;) ├ modeToggle 布尔型 是否显示模式切换按钮 ├ setParentFolderLabels 布尔型 是否把标签设置为父文件夹名而不是当前文件夹名 ├ sizes 数组 数组的第一个值就是默认的页面显示大小 ├ theme 字符串 主题文件夹名2 ├ unmanaged 数组 不要管理包含数组成员的文件夹 └ unmanagedInNewWindow 布尔型 是否在新窗口打开未管理文件夹 注意事项 转换格式可参考Binary_prefix - wiki 2.主题文件夹位于_h5ai/images/themes 自动刷新 — autorefresh 字段 类型 备注 autorefresh / 监视并更新当前文件夹的信息 ├ enabled 布尔型 是否开启此功能 └ interval 数字 刷新的时间间隔，单位毫秒 哈希值生成网址： Online hash generator 自定义 — custom 字段 类型 备注 custom / 可以在列表上面和下面自定义插入内容，支持html和md文件 └ enabled 布尔型 是否开启此功能 下载 — download 字段 类型 备注 download / 监视并更新当前文件夹的信息 ├ enabled 布尔型 是否开启此功能 ├ type 字符串 下载调用程序(&quot;php-tar&quot;, &quot;shell-tar&quot; or &quot;shell-zip&quot;) ├ packageName 字符串 下载压缩包的文件名，为空则使用当前的文件/文件夹名 └ alwaysVisible 布尔型 是否总是在页面上可见 过滤 — filter 字段 类型 备注 filter / 允许对页面中显示的文件/文件夹进行过滤 ├ enabled 布尔型 是否开启此功能 ├ advanced 布尔型 使用高级字母分解方式 ├ debounceTime 数字 防抖动时间，单位毫秒 └ ignorecase 布尔型 是否忽视大小写 文件夹大小 — foldersize 字段 类型 备注 foldersize / 计算文件夹的大小 ├ enabled 布尔型 是否开启此功能 └ type 字符串 计算方法(&quot;php&quot; or &quot;shell-du&quot; ) 谷歌分析代码 — google-analytics-ua 字段 类型 备注 foldersize / 添加谷歌分析代码 ├ enabled 布尔型 是否开启此功能 └ id 字符串 谷歌分析账号ID 详情可以查看： Google Universial Analytics 信息 — info 字段 类型 备注 info / 启用一个文件信息侧边栏 ├ enabled 布尔型 是否开启此功能 ├ show 布尔型 是否在页面中显示边栏 ├ qrcode 布尔型 是否显示二维码 ├ qrFill 字符串 二维码图案颜色 └ qrBack 字符串 二维码背景颜色 国际化 — l10n 字段 类型 备注 l10n / 将程序本地化显示 ├ enabled 布尔型 是否开启此功能 ├ lang 字符串 想要程序显示的语言 └&quot;useBrowserLang 布尔型 是否尝试使用浏览器所使用的语言 h5ai所支持的语言都存放在_h5ai/conf/l10n当中，默认显示英文 piwik分析 — piwik-analytics 字段 类型 备注 piwik-analytics / 添加piwik跟踪js代码 ├ enabled 布尔型 是否开启此功能 ├ baseURL 字符串 根URL └idSite 数字 无 音频预览 — preview-aud 字段 类型 备注 preview-aud / 点击即可播放音频内容 ├ enabled 布尔型 是否开启此功能 ├ size 字符串 根URL └types 数组 文件后缀类型 图片预览 — preview-img 字段 类型 备注 preview-img / 点击即可播放音频内容 ├ enabled 布尔型 是否开启此功能 ├ size 布尔型 为真显示简单信息，为假显示原始数据 └types 数组 文件后缀类型 文本预览 — preview-txt 字段 类型 备注 preview-txt / 点击即可查看文本内容 ├ enabled 布尔型 是否开启此功能 └styles 数组 文件后缀类型 视频预览 — preview-vid 字段 类型 备注 preview-img / 点击即可播放音频内容 ├ enabled 布尔型 是否开启此功能 ├ autoplay 布尔型 是否自动播放 └types 数组 文件后缀类型 搜索 — search 字段 类型 备注 filter / 允许对页面中显示的文件/文件夹进行搜索 ├ enabled 布尔型 是否开启此功能 ├ advanced 布尔型 使用高级字母分解方式 ├ debounceTime 数字 防抖动时间，单位毫秒 └ ignorecase 布尔型 是否忽视大小写 排序 — sort 字段 类型 备注 sort / 默认排序方式 ├ enabled 布尔型 是否开启此功能 ├ column 数字 设置排序列 0-名称 1-日期 2-大小 ├ reverse 布尔型 排序方式 为假-升序 为真-降序 ├ ignorecase 布尔型 是否忽视大小写 ├ natural 布尔型 是否使用自然排序 └folders 数字 哪里放置文件夹 0-顶部 1-原位 2-底部 缩略图 — thumbnails 字段 类型 备注 thumbnails / 多媒体文件显示缩略图 ├ img 数组 文件后缀类型 ├ mov 数组 文件后缀类型 ├ doc 数组 文件后缀类型 ├ delay 数字 显示延迟，单位毫秒 ├ size 数字 缩略图大小 ├ exif 布尔型 是否使用EXIF插件 └ chunksize 字符串 每次请求显示的缩略图 标题 — title 字段 类型 备注 title / 用页面面包屑导航作为网页标题 └ enabled 布尔型 是否开启此功能 文件树 — tree 字段 类型 备注 tree / 在页面中显示文件树 ├ enabled 布尔型 是否开启此功能 ├ show 布尔型 是否在页面中显示文件树 ├ maxSubfolders 数字 显示子文件夹的最大值 ├ naturalSort 布尔型 是否使用自然排序 └ ignorecase 布尔型 是否忽视大小写 ","link":"https://sleepwood.github.io/post/h5ai-config"},{"title":"使用H5ai搭建属于自己的目录显示程序","content":"有时候我们需要分享文件或者随时使用某些文件时，除了使用百度微软等网盘进行分享外，还可以直接把文件存储到自己的服务器上然后搭建目录显示程序进行分享。市面上目录显示程序很多，本文记录一下如何使用H5ai搭建目录显示程序。 系统要求 必须要求： PHP version &gt;= 5.5.0 apache, lighttpd 或 nginx 可选要求： 图片查看支持：PHP GD 插件 视频查看支持：avconv or ffmpeg 软件 PDF查看支持：convert or gm 程序安装 首先从英文官网上下载软件安装包 h5ai 点击右边按钮即可下载 尽量不要从github上下载，因为下载下来需要手动编译，不如直接使用压缩包安装方便 把下载的程序包解压会看到_h5ai这个文件夹，将其上传到你的web目录，这时你的目录大概是这个样子。 DOC_ROOT ├─ _h5ai ├─ your files └─ and folders 访问 http://你的网址/_h5ai/public/index.php 访问程序的安装界面，可以根据安装界面的提示查看程序当前有效的功能。 到目前为止还不能访问搭建的网站，还需要把 /_h5ai/public/index.php 加入到默认首页栏中 Apache httpd(.htaccess) DirectoryIndex index.html index.php /_h5ai/public/index.php lighttpd(lighttpd.conf) index-file.names += (&quot;index.html&quot;, &quot;index.php&quot;, &quot;/_h5ai/public/index.php&quot;) nginx(in nginx.conf) index index.html index.php /_h5ai/public/index.php; 重启对应的web服务端即可应用修改，现在可以访问搭建的网站了。 程序安装后仍然可以通过 http://你的网址/_h5ai/public/index.php 访问程序的安装界面 程序配置 登陆网站后，如果对网站的布局、显示方式等不满意，可以通过h5ai提供的丰富的配置文件进行修改。配置文件在_h5ai/private/conf/options.json，打开配置文件后对程序进行深度自定义，下面记录一下我经常用到的几项配置设置。 &quot;autorefresh&quot;//是否开启自动更新 &quot;crumb&quot; //可点击的面包屑导航 &quot;download&quot;//下载功能，可以自选下载解析方式 &quot;info&quot;//文件信息 &quot;l10n&quot;//国际化 | 翻译 &quot;preview-img&quot;//图片浏览格式 &quot;search&quot;//是否开启搜索功能 …… 配置文件的设置我专门发一篇新的笔记，传送门在这里…… 引用链接 lrsjng/h5ai ","link":"https://sleepwood.github.io/post/h5ai-install"},{"title":"Nginx 反向代理本机端口","content":"除了部署网站外，有时候我还会部署其他类型的服务，它们总是会使用其他端口。为了方便访问和管理，我们会使用Nginx或者Caddy来反向代理本机端口。本文在此记录一下如何配置Nginx来进行域名反代。如果想使用SSL将相应#号删除即可。 在Nginx配置文件中新建一个虚拟主机，将下面的代码复制并替换 注意事项： proxy_pass http://127.0.0.1:1234;中的HTTP,请勿写成HTTPS. proxy_pass http://127.0.0.1:1234;中1234端口为frps的HTTP端口. proxy_set_header Host $host:80;注意需加上80端口,否则会无限循环301跳转,导致网页打不开提示重定向次数过多ERR_TOO_MANY_REDIRECTS. server { listen 80; #listen 443 ssl http2; #你要绑定的域名 server_name *.yourdomain.com; # 301 强制http跳转https #if ($scheme = http) { # return 301 https://$host$request_uri; #} #SSL证书 #ssl_certificate /usr/local/nginx/conf/ssl/yourdomain.com.crt; #ssl_certificate_key /usr/local/nginx/conf/ssl/yourdomain.com.key; client_max_body_size 50m; client_body_buffer_size 256k; client_header_timeout 3m; client_body_timeout 3m; send_timeout 3m; proxy_connect_timeout 300s; proxy_read_timeout 300s; proxy_send_timeout 300s; proxy_buffer_size 64k; proxy_buffers 4 32k; proxy_busy_buffers_size 64k; proxy_temp_file_write_size 64k; proxy_ignore_client_abort on; location / { #被绑定的本机端口 proxy_pass http://127.0.0.1:1234; proxy_redirect off; proxy_set_header Host $host:80; proxy_ssl_server_name on; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } } 引用链接： Nginx 反向代理frps ","link":"https://sleepwood.github.io/post/nginx-proxy"},{"title":"使用Docker Compose搭建属于自己的Bitwarden服务器","content":"随着日常接触到越来越多的平台，越发需要一个靠谱的密码管理工具，之前使用过Keepass但是因为它基于文件存储，同步备份都很困难，又不喜欢1password等一众闭源解决方案——把密码放在别人手里还是有点难受。就在这时，Bitwarden走入了我的视野，开源，云同步，自定义，基本上满足了我对密码管理工具的全部要求。在这里记录一下我是如何使用Docker Compose搭建服务器的。 在终端中运行下面的命令安装 Docker。 curl -sSL https://get.daocloud.io/docker | sh #启动docker sudo service docker start Docker Compose 负责快速在集群中部署分布式应用，本文使用 docker-compose 来管理服务。在本文中我们将使用它来搭建Bitwarden_RS服务器，并使用Caddy代理把WebSocket请求重定向到我们设置好的域名当中。 curl -L https://get.daocloud.io/docker/compose/releases/download/1.12.0/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose chmod +x /usr/local/bin/docker-compose 你可以通过修改URL中的版本，可以自定义您的需要的版本。 接下来复制下面的代码创建一个 docker-compose.yml 文件: # docker-compose.yml version: '3' services: bitwarden: image: bitwardenrs/server restart: always volumes: - ./bw-data:/data environment: WEBSOCKET_ENABLED: 'true' # Required to use websockets SIGNUPS_ALLOWED: 'true' # set to false to disable signups WEB_VAULT_ENABLED: &quot;true&quot; #web客户端 caddy: image: abiosoft/caddy restart: always volumes: - ./Caddyfile:/etc/Caddyfile:ro - caddycerts:/root/.caddy ports: - 80:80 # needed for Let's Encrypt - 443:443 environment: ACME_AGREE: 'true' # agree to Let's Encrypt Subscriber Agreement DOMAIN: 'bitwarden.example.org' # CHANGE THIS! Used for Auto Let's Encrypt SSL EMAIL: 'bitwarden@example.org' # CHANGE THIS! Optional, provided to Let's Encrypt volumes: caddycerts: 然后编辑Caddyfile文件 (不需要进行修改): # Caddyfile {$DOMAIN} { tls {$EMAIL} gzip header / { # Enable HTTP Strict Transport Security (HSTS) Strict-Transport-Security &quot;max-age=31536000;&quot; # Enable cross-site filter (XSS) and tell browser to block detected attacks X-XSS-Protection &quot;1; mode=block&quot; # Disallow the site to be rendered within a frame (clickjacking protection) X-Frame-Options &quot;DENY&quot; # Prevent search engines from indexing (optional) #X-Robots-Tag &quot;none&quot; } # The negotiation endpoint is also proxied to Rocket proxy /notifications/hub/negotiate bitwarden:80 { transparent } # Notifications redirected to the websockets server proxy /notifications/hub bitwarden:3012 { websocket } # Proxy the Root directory to Rocket proxy / bitwarden:80 { transparent } } 运行 docker-compose up -d 来创建并启动这些容器，系统会在两个容器间创建一个私有网络来进行反向代理，只有Caddy被暴露在外。 运行 docker-compose down 停止并删除容器 引用链接： Using Docker Compose - Github 使用Docker搭建Bitwarden密码存储服务器并定时备份数据库 ","link":"https://sleepwood.github.io/post/bitwarden-docker"}]}